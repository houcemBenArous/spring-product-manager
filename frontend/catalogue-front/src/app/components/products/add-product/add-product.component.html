<div class="container mt-4">

  <!-- Header -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="text-primary">Ajouter un nouveau produit</h2>
    <button class="btn btn-outline-secondary" (click)="retourListe()">
      <i class="fas fa-arrow-left"></i> Retour à la liste
    </button>
  </div>

  <div class="card">
    <div class="card-body">
      <form #productForm="ngForm" (ngSubmit)="onSubmit(productForm)">

        <!-- Row 1: Nom & Prix -->
        <div class="row">
          <!-- Nom du produit -->
          <div class="col-md-6 mb-3">
            <label for="nom" class="form-label">Nom du produit *</label>
            <input 
              type="text" 
              id="nom" 
              name="nom"
              class="form-control"
              ngModel 
              #nom="ngModel" 
              required
              [class.is-invalid]="nom.invalid && nom.touched"
            >
          </div>

          <!-- Prix -->
          <div class="col-md-6 mb-3">
            <label for="prix" class="form-label">Prix *</label>
            <input 
              type="number" 
              id="prix" 
              name="prix"
              class="form-control"
              ngModel 
              #prix="ngModel" 
              required
              [class.is-invalid]="prix.invalid && prix.touched"
            >
          </div>
        </div>

        <!-- Row 2: Quantité & Catégorie -->
        <div class="row">
          <!-- Quantité -->
          <div class="col-md-6 mb-3">
            <label for="quantite" class="form-label">Quantité *</label>
            <input 
              type="number" 
              id="quantite" 
              name="quantite"
              class="form-control"
              ngModel 
              #quantite="ngModel" 
              required
              [class.is-invalid]="quantite.invalid && quantite.touched"
            >
          </div>

          <!-- Catégorie -->
          <div class="col-md-6 mb-3">
            <label for="categorie" class="form-label">Catégorie *</label>
            <select 
              id="categorie" 
              name="categorie"
              class="form-select"
              ngModel 
              #categorie="ngModel" 
              required
              [class.is-invalid]="categorie.invalid && categorie.touched"
            >
              <option [ngValue]="null" disabled>Sélectionnez une catégorie</option>
              <option *ngFor="let cat of categories" [ngValue]="cat">
                {{ cat.nom }}
              </option>
            </select>
          </div>
        </div>

        <!-- Row 3: Image Upload -->
        <div class="row">
          <div class="col-md-12 mb-3">
            <label for="image" class="form-label">Image du produit</label>
            
            <!-- File Input -->
            <input 
              type="file" 
              id="image" 
              class="form-control"
              accept="image/*"
              (change)="onFileSelected($event)"
            >
            <small class="text-muted">Formats acceptés: JPG, PNG, GIF (optionnel)</small>

            <!-- Image Preview -->
            <div *ngIf="imagePreview" class="mt-3 position-relative" style="max-width: 300px;">
              <img [src]="imagePreview" alt="Aperçu" class="img-thumbnail" style="width: 100%;">
              <button 
                type="button" 
                class="btn btn-sm btn-danger position-absolute top-0 end-0 m-2"
                (click)="removeImage()"
              >
                <i class="fas fa-times"></i>
              </button>
            </div>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="mt-3">
          <button type="submit" class="btn btn-success" [disabled]="productForm.invalid">
            Enregistrer
          </button>
        </div>

      </form>
    </div>
  </div>

</div>
